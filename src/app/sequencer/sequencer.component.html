<mat-card class="mat-elevation-z0" [ngStyle]="{ 'border-top': '.35em solid ' + currentColor, background: active ? '' : 'none' }">
  <mat-card-title *ngIf="!active">
    <span [ngStyle]="{ color: colorName ? '' : currentColor }">Current lights color</span>
    <span *ngIf="colorName?.length" class="color-name" [ngStyle]="{ color: colorName }">is {{ colorName }}</span>
  </mat-card-title>

  <mat-tab-group *ngIf="active" dynamicHeight="true">
    <mat-tab label="sequence">
      <mat-card-subtitle *ngIf="active">
        <p>Create lights sequence or pick just one color you like most.</p>
        <p *ngIf="colorName?.length">Current lights color is <span class="color-name" [ngStyle]="{ color: colorName }">{{ colorName }}</span></p>
      </mat-card-subtitle>
      <mat-card-subtitle *ngIf="colors.length" class="sequence-description">Sequences length is {{ colors.length }}</mat-card-subtitle>
      <button *ngIf="colors.length" mat-button (click)="send()">Now you can <span class="accent">send</span> {{ colors.length > 1 ? 'sequence' : 'color' }},</button>
      <button mat-button (click)="addColor()"><span class="accent">add</span> color</button>
      <button *ngIf="colors.length" mat-button (click)="clear()">or <span [class]="colors.length > 1 ? 'warn' : 'accent'">{{ colors.length > 1 ? 'clear it.' : 'random color'}}</span></button>
    </mat-tab>

    <mat-tab class="color" *ngFor="let color of colors; let i = index">
      <ng-template mat-tab-label>
        <div class="color-label" [style.background]="rgb(color.rgb)">
          <span>{{ i + 1 }}</span>
        </div>
      </ng-template>

      <mat-toolbar>
        <button mat-button (click)="backToSequence()">back to sequence menu</button>
        <button mat-button color="warn" (click)="removeColor(i)">remove</button>
      </mat-toolbar>

      <div class="color-content">
        <input class="picker" [colorPicker]="rgb(color.rgb)"
               cpDialogDisplay="inline" [cpToggle]="true"
               (colorPickerChange)="setColor(i, $event)"
               cpAlphaChannel="disabled" cpOutputFormat="rgba" />

        <mat-form-field>
          <input matInput [(ngModel)]="color.duration" name="duration" type="number" placeholder="duration">
        </mat-form-field>
      </div>      
    </mat-tab>
  </mat-tab-group>
</mat-card>
